# 迷你终端

这是一个使用输入框作为载体的模拟终端，理论上它可以在手机上任何不会被其他软件干扰的输入框中使用。写这个的目的是希望能够使用类似终端指令的方式完成一些自动化操作，同时这个迷你终端也是微信加密消息的前置。目前这个终端是单线程的，我自己对于用 autojs 的多线程开发并不熟悉，也许以后等我自己搞懂了（或者碰到一个愿意帮我的大佬）会改成多线程来提高效率甚至改成同时可以开启多个终端。

## 使用方法

1. 在 `Hamibot` 的插件市场安装： 传送门 (我还没在插件)
2. 打开你指定的应用，在对应输入框中会显示终端
2. 输入指令，回车执行（不是发送！！！）

> 注意：请勿删除掉终端命令行 `$` 符号及以前的字符，否则可能会导致终端无法运行。

## 可用指令

> 现在刚刚开始，指令非常之少，以后会慢慢添加的

- exit： 退出终端
- version： 显示终端版本

## 自定义指令

可以自己编写指令并挂载到 `src\cmd\operation.js` 中的 `operations` 对象上，键名为调用时的指令。函数需要返回一个对象，其中可以包含三个键：

1. `code` ： 指令的运行状态码，可以是任何整数，但是只有下面几个有实际含义：

   | 状态码 | 类型 | 含义                         |
   | ------ | ------------------------------------------------------------ | ---------------------------- |
   | 1      | 正常状态码                              | 指令运行完成 |
   | 0      | 退出状态码                          |                      运行完指令就退出终端           |
   | -1     | 异常状态码 |               指令运行出错，这个建议通过抛出异常产生，但是也可以通过函数返回               |
   | 其他   | 告警状态码                                           | 指令运行过程中出现问题，但是不影响执行到结束 |

2. `message` ： 用来传递说明信息方便快速定位问题位置，一般建议尽量返回有意义的信息，利于使用过程中发现问题修改指令，只有在返回异常状态码或者告警状态码时会显示。另外返回异常状态码时会从捕获的异常中获取说明信息，返回告警状态码时如果没有返回的说明信息会输出告警状态码本身。

3.  `fill_command` ： 用来填充下一次输入的指令，一般只有操作历史或者自动生成指令的时候会用到。

> 终端会分离指令和参数并传递给对应的函数，不过目前还没写好指令解析的方法，以后应该只需要继承对应的类就可以自动解析。

## TODO List

- [ ] 参数解析方法
- [ ] 基础历史指令操作
- [ ] 隐藏和显示终端指令

## 贡献者

欢迎感兴趣的大佬来和我一起完善这个小玩意~！

## 开源协议

[MPL-2.0 License](https://github.com/batu1579/mini-terminal/blob/master/LICENSE) © BATU1579